{"primaryContentSections":[{"kind":"declarations","declarations":[{"tokens":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"close"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"languages":["swift"],"platforms":["macOS"]}]},{"kind":"content","content":[{"anchor":"discussion","level":2,"type":"heading","text":"Discussion"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Closing a socket does not wait for all outstanding I\/O operations"},{"type":"text","text":" "},{"type":"text","text":"to finish, so the caller should not rely on them to be guaranteed"},{"type":"text","text":" "},{"type":"text","text":"to complete even if the close returns with no error."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Once the socket is closed, all other operations will return"},{"type":"text","text":" "},{"type":"codeVoice","code":"closed"},{"type":"text","text":". Closing a socket multiple times will not"},{"type":"text","text":" "},{"type":"text","text":"return an error."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Sockets will be automatically closed when the last reference"},{"type":"text","text":" "},{"type":"text","text":"is dropped, but you might want to call this function to make sure"},{"type":"text","text":" "},{"type":"text","text":"resources are released as early as possible."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Beware that due to the way that TCP works, it is possible for"},{"type":"text","text":" "},{"type":"text","text":"recently-sent data to be lost if either you close a socket while the"},{"type":"text","text":" "},{"type":"text","text":"[in_](\/\/documentation\/glib\/in_ condition is set, or else if the remote connection tries to"},{"type":"text","text":" "},{"type":"text","text":"send something to you after you close the socket but before it has"},{"type":"text","text":" "},{"type":"text","text":"finished reading all of the data you sent. There is no easy generic"},{"type":"text","text":" "},{"type":"text","text":"way to avoid this problem; the easiest fix is to design the network"},{"type":"text","text":" "},{"type":"text","text":"protocol such that the client will never send data “out of turn”."},{"type":"text","text":" "},{"type":"text","text":"Another solution is for the server to half-close the connection by"},{"type":"text","text":" "},{"type":"text","text":"calling "},{"type":"codeVoice","code":"g_socket_shutdown()"},{"type":"text","text":" with only the "},{"type":"codeVoice","code":"shutdown_write"},{"type":"text","text":" flag set,"},{"type":"text","text":" "},{"type":"text","text":"and then wait for the client to notice this and close its side of the"},{"type":"text","text":" "},{"type":"text","text":"connection, after which the server can safely call "},{"type":"codeVoice","code":"g_socket_close()"},{"type":"text","text":"."},{"type":"text","text":" "},{"type":"text","text":"(This is what "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/TcpConnection"},{"type":"text","text":" does if you call"},{"type":"text","text":" "},{"type":"codeVoice","code":"g_tcp_connection_set_graceful_disconnect()"},{"type":"text","text":". But of course, this"},{"type":"text","text":" "},{"type":"text","text":"only works if the client will close its connection after the server"},{"type":"text","text":" "},{"type":"text","text":"does.)"}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"variants":[{"paths":["\/documentation\/gio\/socket\/close()"],"traits":[{"interfaceLanguage":"swift"}]}],"identifier":{"url":"doc:\/\/GIO\/documentation\/GIO\/Socket\/close()","interfaceLanguage":"swift"},"abstract":[{"type":"text","text":"Closes the socket, shutting down any active connection."}],"kind":"symbol","metadata":{"role":"symbol","title":"close()","roleHeading":"Instance Method","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"close"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"symbolKind":"method","externalID":"s:3GIO14SocketProtocolPAAE5closeSbyKF::SYNTHESIZED::s:3GIO6SocketC","extendedModule":"GIO","modules":[{"name":"GIO"}]},"hierarchy":{"paths":[["doc:\/\/GIO\/documentation\/GIO","doc:\/\/GIO\/documentation\/GIO\/Socket","doc:\/\/GIO\/documentation\/GIO\/Socket\/SocketProtocol-Implementations"]]},"references":{"doc://GIO/documentation/GIO/SocketConnection":{"role":"symbol","title":"SocketConnection","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"SocketConnection"}],"abstract":[{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/SocketConnection"},{"type":"text","text":" is a "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/IOStream"},{"type":"text","text":" for a connected socket. They"},{"type":"text","text":" "},{"type":"text","text":"can be created either by "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/SocketClient"},{"type":"text","text":" when connecting to a host,"},{"type":"text","text":" "},{"type":"text","text":"or by "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/SocketListener"},{"type":"text","text":" when accepting a new client."}],"identifier":"doc:\/\/GIO\/documentation\/GIO\/SocketConnection","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"SocketConnection"}],"url":"\/documentation\/gio\/socketconnection"},"doc://GIO/documentation/GIO":{"role":"collection","title":"GIO","abstract":[],"identifier":"doc:\/\/GIO\/documentation\/GIO","kind":"symbol","type":"topic","url":"\/documentation\/gio"},"doc://GIO/documentation/GIO/Socket/SocketProtocol-Implementations":{"role":"collectionGroup","title":"SocketProtocol Implementations","abstract":[],"identifier":"doc:\/\/GIO\/documentation\/GIO\/Socket\/SocketProtocol-Implementations","kind":"article","type":"topic","url":"\/documentation\/gio\/socket\/socketprotocol-implementations"},"doc://GIO/documentation/GIO/Socket/close()":{"role":"symbol","title":"close()","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"close"},{"kind":"text","text":"() "},{"kind":"keyword","text":"throws"},{"kind":"text","text":" -> "},{"kind":"typeIdentifier","text":"Bool","preciseIdentifier":"s:Sb"}],"abstract":[{"type":"text","text":"Closes the socket, shutting down any active connection."}],"identifier":"doc:\/\/GIO\/documentation\/GIO\/Socket\/close()","kind":"symbol","type":"topic","url":"\/documentation\/gio\/socket\/close()"},"doc://GIO/documentation/GIO/TcpConnection":{"role":"symbol","title":"TcpConnection","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"TcpConnection"}],"abstract":[{"type":"text","text":"This is the subclass of "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/SocketConnection"},{"type":"text","text":" that is created"},{"type":"text","text":" "},{"type":"text","text":"for TCP\/IP sockets."}],"identifier":"doc:\/\/GIO\/documentation\/GIO\/TcpConnection","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"TcpConnection"}],"url":"\/documentation\/gio\/tcpconnection"},"doc://GIO/documentation/GIO/Socket":{"role":"symbol","title":"Socket","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"Socket"}],"abstract":[{"type":"text","text":"A "},{"type":"reference","isActive":true,"identifier":"doc:\/\/GIO\/documentation\/GIO\/Socket"},{"type":"text","text":" is a low-level networking primitive. It is a more or less"},{"type":"text","text":" "},{"type":"text","text":"direct mapping of the BSD socket API in a portable GObject based API."},{"type":"text","text":" "},{"type":"text","text":"It supports both the UNIX socket implementations and winsock2 on Windows."}],"identifier":"doc:\/\/GIO\/documentation\/GIO\/Socket","kind":"symbol","type":"topic","navigatorTitle":[{"kind":"identifier","text":"Socket"}],"url":"\/documentation\/gio\/socket"}}}